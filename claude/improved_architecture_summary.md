# π”„ κ°μ„ λ λ€ν™”ν• μ•„ν‚¤ν…μ² ν•µμ‹¬ μ”μ•½

## β¨ μ£Όμ” κ°μ„ μ‚¬ν•­

### 1. **μ‚¬μ©μ μ¤‘μ‹¬ μƒνΈμ‘μ©**
- β **κΈ°μ΅΄**: μΌλ°©ν–¥μ  ν”λλ‹ (μ‹μ¤ν… β†’ μ‚¬μ©μ)
- β… **κ°μ„ **: μλ°©ν–¥ λ€ν™”ν• ν”λλ‹ (μ‚¬μ©μ β†” μ‹μ¤ν…)

### 2. **μ μ—°ν• λ€ν™” μƒνƒ κ΄€λ¦¬**
```python
ConversationState = [
    "INITIAL_PLANNING",          # μ΄κΈ° κ³„ν
    "AWAITING_USER_SELECTION",   # μ‚¬μ©μ μ„ νƒ λ€κΈ° β­
    "PLANNING_IN_PROGRESS",      # κ³„ν μ§„ν–‰ μ¤‘
    "PRESENTING_RESULTS",        # κ²°κ³Ό μ μ‹
    "HANDLING_QUESTIONS",        # μ§λ¬Έ μ²λ¦¬ β­
    "MODIFYING_PLAN",           # κ³„ν μμ • β­
    "PLAN_CONFIRMED",           # κ³„ν ν™•μ •
    "REAL_TIME_ASSISTANCE"      # μ‹¤μ‹κ°„ μ§€μ› β­
]
```

### 3. **λ‹¤μ–‘ν• μƒνΈμ‘μ© ν¨ν„΄**

#### π― **μ„ νƒν• μƒνΈμ‘μ©**
```
μ‹μ¤ν…: "5κ° κ΄€κ΄‘μ§€λ¥Ό μ°Ύμ•μ–΄μ”. μ–΄λ””μ— κ°€κ³  μ‹¶μΌμ„Έμ”?"
μ‚¬μ©μ: "1λ²μ΄λ‘ 3λ²!"
μ‹μ¤ν…: "μ„ νƒ μ™„λ£! μµμ  κ²½λ΅ κ³„μ‚° μ¤‘..."
```

#### π’¬ **μ§λ¬Έν• μƒνΈμ‘μ©**  
```
μ‚¬μ©μ: "κ²½λ³µκ¶μ— λ€ν•΄ λ” μμ„Έν μ•λ ¤μ¤"
μ‹μ¤ν…: "π“ μ—­μ‚¬, π—οΈ κ±΄μ¶•, π’΅ ν λ“± μƒμ„Έ μ •λ³΄ μ κ³µ"
```

#### π”§ **μμ •ν• μƒνΈμ‘μ©**
```
μ‚¬μ©μ: "μ‹κ°„μ„ λ” μ—¬μ λ΅­κ² ν•΄μ¤"
μ‹μ¤ν…: "π”„ μ—¬μ λ΅μ΄ μΌμ •μΌλ΅ μ¬μ΅°μ • μ™„λ£!"
```

#### β΅ **μ‹¤μ‹κ°„ μ§€μ›**
```
μ‚¬μ©μ: "μ§€κΈ κ²½λ³µκ¶ νΌμ΅λ„λ” μ–΄λ•?"
μ‹μ¤ν…: "π‘¥ ν„μ¬ λ³΄ν†µ, 15λ¶„ ν›„ νΌμ΅ μμƒ"
```

## π—οΈ μ•„ν‚¤ν…μ² κµ¬μ„± μ”μ†

### 1. **ConversationManager**
- λ€ν™” μƒνƒ μ¶”μ  λ° κ΄€λ¦¬
- μ‚¬μ©μ μλ„ λ¶„μ„
- μ»¨ν…μ¤νΈ μ μ§€

### 2. **InteractionHandler**  
- μ‹λ‚λ¦¬μ¤λ³„ μƒνΈμ‘μ© μ²λ¦¬
- UI μ”μ† μƒμ„± (λ²„νΌ, μ„ νƒμ§€)
- μ‚¬μ©μ μ…λ ¥ κ²€μ¦

### 3. **ν™•μ¥λ μ—μ΄μ „νΈ μ—­ν• **
```python
# κΈ°μ΅΄: λ‹¨μ μ •λ³΄ μ κ³µ
tourist_agent.search() β†’ List[TouristSpot]

# κ°μ„ : μƒνΈμ‘μ© μ§€μ›  
tourist_agent.search() β†’ List[TouristSpot]
tourist_agent.get_detailed_info(spot_name) β†’ DetailedInfo
tourist_agent.get_real_time_status(spot_id) β†’ RealTimeStatus
```

## π“ μƒνΈμ‘μ© λ°μ΄ν„° νλ¦„

### **Phase 1: μ΄κΈ° κ³„ν**
```
μ‚¬μ©μ μ§μ β†’ νμ‹± β†’ μ—μ΄μ „νΈ μ΅°μ‚¬ β†’ μ„ νƒμ§€ μ μ‹ β†’ μ‚¬μ©μ μ„ νƒ
```

### **Phase 2: μ„Έλ¶€ μ΅°μ •**  
```
κ³„ν μ μ‹ β†’ μ‚¬μ©μ μ§λ¬Έ/μμ • μ”μ²­ β†’ μ¶”κ°€ μ΅°μ‚¬/μ¬κ³„ν β†’ μμ •λ κ³„ν
```

### **Phase 3: ν™•μ • λ° μ§€μ›**
```
μµμΆ… ν™•μ • β†’ μΌμ • μ €μ¥ β†’ λ‹ΉμΌ μ•λ¦Ό β†’ μ‹¤μ‹κ°„ μ§€μ›
```

## π― μ‚¬μ©μ κ²½ν— κ°μ„  ν¬μΈνΈ

### 1. **μ„ νƒμ μμ¨μ„±**
- μ‹μ¤ν…μ΄ λ¨λ“  κ²ƒμ„ κ²°μ •ν•μ§€ μ•μ
- μ‚¬μ©μκ°€ μ›ν•λ” μµμ…μ„ μ§μ ‘ μ„ νƒ
- λ€μ• μ μ‹λ΅ μ μ—°μ„± ν™•λ³΄

### 2. **μ •λ³΄μ ν¬λ…μ„±**
- "μ™ μ΄ μ¥μ†λ¥Ό μ¶”μ²ν•λ”μ§€" μ„¤λ…
- μ‹¤μ‹κ°„ μƒν™© μ •λ³΄ μ κ³µ 
- μμ‚° μƒμ„Έ λ¶„μ„ μ κ³µ

### 3. **κ°μΈν™” μμ¤€ ν–¥μƒ**
```python
# μ‚¬μ©μ μ„ νƒ νμ¤ν† λ¦¬ ν•™μµ
user_preferences = {
    "preferred_categories": ["λ¬Έν™”μ¬", "μΉ΄ν"],
    "budget_sensitivity": "moderate", 
    "pace_preference": "relaxed",
    "interaction_style": "detailed_info_seeker"
}
```

### 4. **μ—°μ†μ  μ§€μ›**
- κ³„ν λ‹¨κ³„μ—μ„ λλ‚μ§€ μ•μ
- λ‹ΉμΌ μ‹¤μ‹κ°„ μ§€μ› μ κ³µ
- ν”Όλ“λ°± μμ§‘ λ° ν•™μµ

## π”§ κΈ°μ μ  κµ¬ν„ κ³ λ ¤μ‚¬ν•­

### 1. **μƒνƒ λ™κΈ°ν™”**
```python
# Redisλ¥Ό ν†µν• μ‹¤μ‹κ°„ μƒνƒ κ΄€λ¦¬
conversation_state = {
    "current_stage": "awaiting_selection",
    "pending_choices": [...],
    "context_history": [...],
    "user_preferences": {...}
}
```

### 2. **μ‘λ‹µ μ‹κ°„ μµμ ν™”**
```python
# λ―Έλ¦¬ μ¤€λΉ„λ μ •λ³΄ vs μ‹¤μ‹κ°„ μ΅°ν
if user_asks_common_question:
    return cached_detailed_info
else:
    return await real_time_research()
```

### 3. **μ¤λ¥ λ³µκµ¬ λ©”μ»¤λ‹μ¦**
```python
# μ‚¬μ©μ μ…λ ¥ μ΄ν•΄ μ‹¤ν¨ μ‹
if parse_failed:
    return clarification_questions
    # "νΉμ‹ μ΄λ° λ»μ΄μ‹ κ°€μ”?" + μ„ νƒμ§€ μ μ‹
```

## π­ μ‹¤μ  λ€ν™” μμ‹ ν¨ν„΄

### **ν¨ν„΄ 1: μ μ§„μ  μƒμ„Έν™”**
```
1. "μ„μΈ λ°μ΄νΈ κ³„ν" (λ¨νΈν• μ”μ²­)
2. β†’ κ΄€κ΄‘μ§€ μ„ νƒμ§€ μ μ‹
3. β†’ μ„ νƒλ μ¥μ†μ μƒμ„Έ μ •λ³΄ μ”μ²­
4. β†’ μΌμ • μ΅°μ • μ”μ²­
5. β†’ μµμΆ… ν™•μ •
```

### **ν¨ν„΄ 2: νΈκΈ°μ‹¬ μ£Όλ„ν•**
```
1. κΈ°λ³Έ κ³„ν μ™„μ„±
2. β†’ "κ²½λ³µκ¶μ΄ λ­κ°€ νΉλ³„ν•΄?"
3. β†’ "λ‚ μ”¨λ” μ–΄λ•?"  
4. β†’ "λΉ„μ©μ΄ μ–Όλ§λ‚ λ“¤μ–΄?"
5. β†’ λ¨λ“  μ •λ³΄ ν™•μΈ ν›„ ν™•μ •
```

### **ν¨ν„΄ 3: μμ • λ°λ³µν•**
```
1. μ΄κΈ° κ³„ν μ μ‹
2. β†’ "μ‹κ°„ μ΅°μ •ν•΄μ¤"
3. β†’ "μμ‚° μ¤„μ—¬μ¤"
4. β†’ "λ‹¤λ¥Έ μ¥μ† μ¶”μ²ν•΄μ¤"
5. β†’ μ—¬λ¬ μμ • ν›„ λ§μ΅±μ¤λ¬μ΄ κ³„ν
```

## π€ λ‹¤μ κµ¬ν„ μ°μ„ μμ„

1. **ConversationManager** - λ€ν™” μƒνƒ κ΄€λ¦¬ ν•µμ‹¬
2. **InteractionHandler** - μ‹λ‚λ¦¬μ¤λ³„ μ²λ¦¬ λ΅μ§
3. **ν™•μ¥λ μ—μ΄μ „νΈλ“¤** - μƒνΈμ‘μ© μ§€μ› κΈ°λ¥
4. **UI μ»΄ν¬λ„νΈ** - μ„ νƒ, λ²„νΌ, μ§„ν–‰ μƒν™© ν‘μ‹

μ΄μ  **μ§„μ •ν• λ€ν™”ν• AI ν”λλ„**κ°€ μ™„μ„±λ©λ‹λ‹¤! π‰